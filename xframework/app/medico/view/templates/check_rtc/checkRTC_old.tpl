

<link rel="stylesheet" href="{$url}xframework/app/themes/dp02/css/checkrtc.css">
    
<div class="top-verde-centrado">
    <h1><i class="fa fa-check-circle-o"></i> {"Chequeo de compatibilidad para Video Consultas"|x_translate}</h1>
</div>

<section class="container testEnvironment" id="testEnvironment">

    

        <div class="row">
         
            <div class="testItem" style="margin-left:auto; margin-right:important;">

                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 63 63" style="width:40px;" xml:space="preserve">
                                {literal}<style type="text/css">
                                        .st0{fill:#C9CCD3;}
                                        .st1{fill:none;stroke:#3F4451;stroke-width:3;stroke-miterlimit:10;}
                                        .st2{fill:none;stroke:#C9CCD3;stroke-width:3;stroke-miterlimit:10;}
                                </style>
                                {/literal}
                                <g>
                                        <path class="st0 FqyDUOZW_0" d="M31.5,60C15.8,60,3,47.2,3,31.5S15.8,3,31.5,3S60,15.8,60,31.5S47.2,60,31.5,60z M31.5,6C17.4,6,6,17.4,6,31.5
                                                S17.4,57,31.5,57S57,45.6,57,31.5S45.6,6,31.5,6z"></path>
                                </g>
                                <path class="st1 FqyDUOZW_1" d="M4.5,31.5A27,27 0,1,1 58.5,31.5A27,27 0,1,1 4.5,31.5"></path>
                                <path class="st2 FqyDUOZW_2" d="M4.5,31.5A27,27 0,1,1 58.5,31.5A27,27 0,1,1 4.5,31.5"></path>
                                {literal}
                                <style>.FqyDUOZW_0{stroke-dasharray:340 342;stroke-dashoffset:341;animation:FqyDUOZW_draw_0 1500ms ease-in-out 0ms infinite,FqyDUOZW_fade 1500ms linear 0ms infinite;}.FqyDUOZW_1{stroke-dasharray:170 172;stroke-dashoffset:171;animation:FqyDUOZW_draw_1 1500ms ease-in-out 0ms infinite,FqyDUOZW_fade 1500ms linear 0ms infinite;}.FqyDUOZW_2{stroke-dasharray:170 172;stroke-dashoffset:171;animation:FqyDUOZW_draw_2 1500ms ease-in-out 0ms infinite,FqyDUOZW_fade 1500ms linear 0ms infinite;}@keyframes FqyDUOZW_draw{100%{stroke-dashoffset:0;}}@keyframes FqyDUOZW_fade{0%{stroke-opacity:1;}100%{stroke-opacity:1;}100%{stroke-opacity:0;}}@keyframes FqyDUOZW_draw_0{0%{stroke-dashoffset: 341}66.66666666666666%{ stroke-dashoffset: 0;}100%{ stroke-dashoffset: 0;}}@keyframes FqyDUOZW_draw_1{16.666666666666664%{stroke-dashoffset: 171}83.33333333333334%{ stroke-dashoffset: 0;}100%{ stroke-dashoffset: 0;}}@keyframes FqyDUOZW_draw_2{33.33333333333333%{stroke-dashoffset: 171}100%{ stroke-dashoffset: 0;}100%{ stroke-dashoffset: 0;}}</style>
                                {/literal}
                                </svg>

                        <h2 id="testing">{"Testing..."|x_translate}</h2>
            </div>
        </div>            
        <div class="row">

          <div class="col-md-3 testItem" id="isWebRTCSupported">

                <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/minus.png">
                <h2>{"Soporte para RTC en su explorador"|x_translate}</h2>
                <div class="progressContainer">
                  <span class="progress "></span>
                </div>
          </div>

         
        <div class="col-md-3 testItem" id="isWebsiteHasWebcamPermissions">     
                <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/camOk.png">
                <h2>{"Permisos para que DoctorPlus utilice su cámara"|x_translate}</h2>
                <div class="progressContainer">
                  <span class="progress "></span>
                </div>			
        </div>

        <div class="col-md-3 testItem" id="isWebsiteHasMicrophonePermissions">     
                <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/micOk.png">
                <h2>{"Permisos para que DoctorPlus utilice su micrófono"|x_translate}</h2>
                <div class="progressContainer">
                  <span class="progress "></span>
                </div>			
        </div>
            
        <div class="col-md-3 testItem" id="isConnectionquality">     
                <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/wifi.png">
                <h2>{"Velocidad de Conexión"|x_translate}</h2>
                <div class="progressContainer">
                  <span class="progress"></span>
                </div>			
        </div>

  </div>

    
</section>
    
    <section id="testResults" class="testResults" style="display:none">
	<div class="container exito" style="display:none" id="resultOK">
		<div class="row">
			<div class="col-md-8 col-md-offset-2 text-center">
			<div class="animationContainer animated rubberBand">
			<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 85 82" xml:space="preserve">
		{literal}
                <style type="text/css">
			.st00{fill:#EAEAEA;}
			.st10{clip-path:url(#SVGID_2_);fill:none;stroke:#6A6F72;stroke-width:80;stroke-linecap:round;stroke-miterlimit:10;}
			.st20{fill:none;stroke:#00E7B6;stroke-width:5;stroke-linecap:round;stroke-miterlimit:10;}
			.st30{fill:none;stroke:#BA4343;stroke-width:5;stroke-linecap:round;stroke-miterlimit:10;}
		</style>
                {/literal}
		<g>
			<path class="st20 CVKuhQYc_0" d="M67.6,19.5c0.2,0.2,0.4,0.5,0.6,0.7c0.2,0.2,0.4,0.5,0.6,0.7c4.2,5.5,6.7,12.5,6.7,20c0,18.2-14.8,33-33,33
				s-33-14.8-33-33s14.8-33,33-33c9.4,0,17.9,3.9,23.9,10.3c0.3,0.4,0.7,0.7,1,1.1"></path>
			<path class="st20 CVKuhQYc_1" d="M66.9,19.8L35.3,51.3L23,39"></path>
		</g>
                {literal}
		<style>.CVKuhQYc_0{stroke-dasharray:208 210;stroke-dashoffset:209;animation:CVKuhQYc_draw 918ms ease-out 0ms forwards;}.CVKuhQYc_1{stroke-dasharray:63 65;stroke-dashoffset:64;animation:CVKuhQYc_draw 281ms ease-out 918ms forwards;}@keyframes CVKuhQYc_draw{100%{stroke-dashoffset:0;}}@keyframes CVKuhQYc_fade{0%{stroke-opacity:1;}92.5925925925926%{stroke-opacity:1;}100%{stroke-opacity:0;}}
                </style>
                {/literal}
                        </svg>
			</div>
			<h3>{"Usted puede realizar una video consulta"|x_translate}</h3>
			<p>{* {"Mensaje de exito cuando  se compelto el check de rtc"|x_translate} *}</p>
			<hr>
                            <div class="text-center"><a href="javascript:history.back();" class="btn btn-blue">{"volver"|x_translate}<a></div>
			</div>
		</div>
	</div>
        <div class="container errorMessage"  style="display:none"  id="resultKO">
		<div class="row">
			<div class="col-md-8 col-md-offset-2 text-center">
			<div class="animationContainer animated pulse">
			
				<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 85 82" xml:space="preserve">
		{literal}
                <style type="text/css">
			.st000{fill:#EAEAEA;}
			.st100{clip-path:url(#SVGID_2_);fill:none;stroke:#6A6F72;stroke-width:80;stroke-linecap:round;stroke-miterlimit:10;}
			.st200{fill:none;stroke:#00E7B6;stroke-width:5;stroke-linecap:round;stroke-miterlimit:10;}
			.st300{fill:none;stroke:#BA4343;stroke-width:5;stroke-linecap:round;stroke-miterlimit:10;}
		</style>
                {/literal}
		<path class="st300 XIkPkPTZ_0" d="M9.5,41A33,33 0,1,1 75.5,41A33,33 0,1,1 9.5,41"></path>
		<g>
			<path class="st300 XIkPkPTZ_1" d="M29.5,28L55.5,54"></path>
			<path class="st300 XIkPkPTZ_2" d="M29.5,54L55.5,28"></path>
		</g>
                {literal}
		<style>.XIkPkPTZ_0{stroke-dasharray:208 210;stroke-dashoffset:209;animation:XIkPkPTZ_draw 879ms ease-in-out 0ms forwards;}.XIkPkPTZ_1{stroke-dasharray:37 39;stroke-dashoffset:38;animation:XIkPkPTZ_draw 160ms ease-in-out 879ms forwards;}.XIkPkPTZ_2{stroke-dasharray:37 39;stroke-dashoffset:38;animation:XIkPkPTZ_draw 160ms ease-in-out 1040ms forwards;}@keyframes XIkPkPTZ_draw{100%{stroke-dashoffset:0;}}@keyframes XIkPkPTZ_fade{0%{stroke-opacity:1;}92.5925925925926%{stroke-opacity:1;}100%{stroke-opacity:0;}}</style>
                {/literal}
                                </svg>
                
			</div>
                            
                        
			<h3>{"Título de la página has error checkrtc"|x_translate}</h3>
			<p>{"Mensaje de falla cuando no se pudo compeltar el check de rtc"|x_translate}</p>
			<hr>
                            
                        <div id="isWebRTCSupported_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/minus.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Soporte para RTC en su explorador"|x_translate}</h4>
                            <p class="errorDetail">{"Su explorador está desactualizado o no es compatible con la tecnología WebRTC requerida para inicial la consulta. Recomentamos que utilice Chrome, Firefox, Opera o Safari en sus últimas versiones. Si está utilizando MAC asegúrese de tener el sistema operativo actualizado"|x_translate}</p>
                            <hr>
                        </div>
                            
                        <div id="hasWebcam_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/webcam.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Su dispositivo posee cámara"|x_translate}</h4>
                            <p class="errorDetail">{"No hemos detectado que su dispositivo posea cámara. Es necesario para que su médico pueda verlo en el momento de la consulta. Asegúrese de tener una cámara instalada o correctamente configurada en su explorador."|x_translate}</p>
                            <hr>
                        </div>
                           
                        <div id="hasMicrophone_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/microphone.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Su dispositivo posee micrófono"|x_translate}</h4>
                            <p class="errorDetail">{"No hemos detectado que su dispositivo posea micrófono. Es necesario para que su médico pueda escucharlo en el momento de la consulta. Asegúrese de tener un micrófono instalada o correctamente configurado en su explorador."|x_translate}</p>
                            <hr>
                        </div>
                            
                         <div id="hasSpeakers_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/headphones.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Su dispositivo puede reproducir sonido"|x_translate}</h4>
                            <p class="errorDetail">{"No hemos detectado que su dispositivo posea parlantes. Es necesario para que pueda oir a su médico durante la consulta.  Asegúrese de tener parlantes o auriculares correctamente configuradas en su explorador."|x_translate}</p>
                            <hr>
                        </div>
                        
                        <div id="isWebsiteHasWebcamPermissions_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/camOk.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Permisos para que DoctorPlus utilice su cámara"|x_translate}</h4>
                            <p class="errorDetail">{"En la configuración de su sitio web no se han otorgado permisos al sitio web www.doctorplus.com.ar para utilizar el recurso Cámara. Por favor asegurese de tener habilitado dichos permisos."|x_translate}</p>
                            <hr>
                        </div>
                            
                        <div id="isWebsiteHasMicrophonePermissions_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/micOk.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Permisos para que DoctorPlus utilice su micrófono"|x_translate}</h4>
                            <p class="errorDetail">{"En la configuración de su sitio web no se han otorgado permisos al sitio web www.doctorplus.com.ar para utilizar el recurso Micrófono. Por favor asegurese de tener habilitado dichos permisos."|x_translate}</p>
                            <hr>
                        </div>
                            
                        <div id="isConnectionquality_error" style="display:none">
                            <img src="{$url}xframework/app/themes/dp02/imgs/checkrtc/wifi.png"><br>
                            <small>{"ERROR"|x_translate}</small>
                            <h4>{"Velocidad de Conexión"|x_translate}</h4>
                            <p class="errorDetail">{"La velocidad de su conexión a internet no es suficiente para llevar a cabo una videoconsutla en forma fluida."|x_translate}</p>
                            <hr>
                        </div>
                            
			
                        <div class="text-center" ><a href="javascript:history.back();" class="btn btn-blue">{"Volver"|x_translate}</a>
			</div>
		</div>
        </div>
    </section>

<script type="text/javascript" src="https://static.opentok.com/v2/js/opentok.min.js"></script>
<script src="{$url}xframework/files/session_conectividad.js"></script>
<script src="{$url}xframework/core/libs/libs_js/bundle_test_conectividad.js"></script>

{literal}
<script>
    $(document).ready(function () {
        // <NUEVO SEBA TOKBOX
        console.log("iniciando...");
        startTest(tokSession)
                .then( function(DetectRTC){ 
                    
                    console.log(DetectRTC);
                    

                    var resultado = 0;
            
                    //isWebRTCSupported: true, isWebsiteHasWebcamPermissions: false, isWebsiteHasMicrophonePermissions: true, quality_audio: 4.049152070124364, quality_video: 0}
                    
                    // $('.testResults').delay(15500).fadeIn(1500);
                   
                    if (DetectRTC.isWebRTCSupported === false) {
                        //alert('WebRTC No está soportado por el explorador');
                        $("#isWebRTCSupported > div > span").addClass("hasError d-2");
                        $("#isWebRTCSupported_error").show();
                        resultado++;                

                    } else {
                           $("#isWebRTCSupported > div > span").addClass("Ok  d-2");
                    }

                   
                    if (DetectRTC.isWebsiteHasWebcamPermissions === false) {
                        //alert('El sitio web no tiene permiso de acceder a la camara web.');
                        $("#isWebsiteHasWebcamPermissions > div > span").addClass("hasError d-3");
                        $("#isWebsiteHasWebcamPermissions_error").show();
                        resultado++;

                    }  else {
                        $("#isWebsiteHasWebcamPermissions > div > span").addClass("Ok d-3");
                    }
                    
                    //alert("DetectRTC.isWebsiteHasMicrophonePermissions " + isWebsiteHasMicrophonePermissions);
                    if (DetectRTC.isWebsiteHasMicrophonePermissions === false) {
                       
                      //  alert('El sitio web no tiene permiso de acceder a la camara web.');
                        $("#isWebsiteHasMicrophonePermissions > div > span").addClass("hasError d-4");
                        $("#isWebsiteHasMicrophonePermissions_error").show();
                        resultado++;

                    }  else {
                       
                        $("#isWebsiteHasMicrophonePermissions > div > span").addClass("Ok d-4");
                    }
                   
                    // Nuevo check para ver si hay conexion ok (calidad de la conexión)
                   
                    // > 3.8 Excelente; > 3.1 Roog; >2.4 Minimun >1.7 POOR
                    var isConnectionquality = true;
                    if (DetectRTC.quality_audio < 2.4 || DetectRTC.quality_video < 2.4) {
                        
                        isConnectionquality = false;
                    } 
                    
                     //DetectRTC.isWebsiteHasMicrophonePermissions;

                    if (isConnectionquality === false) {
                      //  alert('El sitio web no tiene permiso de acceder a la camara web.');
                        $("#isConnectionquality > div > span").addClass("hasError d-5");
                        $("#isConnectionquality_error").show();
                        resultado++;

                    }  else {
                        $("#isConnectionquality > div > span").addClass("Ok d-5");
                    }

                    // Controles según los resultados
                    $('.testResults').delay(15000).fadeIn(1500);
                    if (resultado > 0) {
                        $("#resultKO").show();
                        $('.testEnvironment').delay(15000).fadeOut(1500);
                    } else {
                        $("#resultOK").show();
                        $('.testEnvironment').delay(15000).fadeOut(1500);

                    }
                    
                });
        // </NUEVO SEBA TOKBOX
        
        /*
        $.browser.chrome = /chrom(e|ium)/.test(navigator.userAgent.toLowerCase());
        
        var resultado = 0;
        navigator.mediaDevices.getUserMedia({audio: true, video: true }).then(function(stream) {
            var temp = document.createElement('video');
            temp.srcObject = stream;
            temp.volume = 0;
            temp.play();        
            DetectRTC.load(function() {
                
                //alert("DetectRTC.isWebRTCSupported: " + DetectRTC.isWebRTCSupported);

                

            });
        });
        */
            
});




    
</script>
{/literal}    

{literal}
<script>
    $(function () {        
        localStorage.setItem('hide_checkrtc_modal', 1);
    });
    
</script>
{/literal}
{x_load_js}


